var moonshine = require("moonshine-core"),
    settings = moonshine.settings,
    logger = moonshine.logFactory(),
    http = require('http');

function RunServer(){

}
RunServer.prototype.execute = function(args,cb){
    try {
        var httpServer =moonshine.server.httpServer =http.createServer(moonshine.server.app)
        httpServer.listen(settings.SERVER_PORT)
        httpServer.on("listening",function(){
            logger.info("Server listening on port %d in %s modes",httpServer.address().port,settings.env)
            moonshine.server.shutdown = function(cb){
                moonshine.server.httpServer.close(cb)
            }
            cb()
        })
        httpServer.on("error",function(err){
            logger.error("could not start server, got exception binding address",err);
            cb(err)
        })
    } catch(e){
        cb(e)
    }
}

module.exports.runserver = RunServer