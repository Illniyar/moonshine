
function loadSettingsModule(resolver,name) {
    var moduleSettings = null;
    try {
        moduleSettings = resolver.require(name)
    } catch(e){
        if (e.code && e.code == "MODULE_NOT_FOUND" ){
            return null
        }
        throw e;
    }
    return moduleSettings
}
module.exports.performActionOnSettings = function(resolver,envs,action){
    action(loadSettingsModule(resolver,"./settings"))
    for (var i=0;i<envs.length;i++) {
        var name = "./settings." + envs[i].toLowerCase()
        action(loadSettingsModule(resolver,name))
    }
}
function parseEnvString(envString) {
    return envString.split(",")
}
module.exports.getEnvironment = function(){
    for (var i =0;i<process.argv.length;i++){
        var arg = process.argv[i]
        if (arg.indexOf("--environment") == 0) {
            return parseEnvString(arg.substr(14))
        }
    }
    if (process.argv.indexOf("test") >= 0) {
        return ["TEST"]
    }
    if (process.env.MOONSHINE_ENVIRONMENT) {
        return parseEnvString(process.env.MOONSHINE_ENVIRONMENT)
    }
    return ["DEV"]
}
